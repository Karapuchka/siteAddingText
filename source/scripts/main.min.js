"use strict";const detect=new MobileDetect(window.navigator.userAgent),modalAddNote=document.forms.addNote,modalFilter=document.querySelector(".options__filter-modal"),searchInput=document.querySelector(".options__seacrh"),addNoteBtn=document.querySelector(".add-note__btn"),noteList=document.querySelector(".note-list"),countNoteFooter=document.getElementById("count-note__item"),templateNote=document.getElementById("note-layout"),filterBtn=document.getElementById("filter-btn");if(0<window.localStorage.length)for(let e=0;e<window.localStorage.length;e++){let t=localStorage.getItem(localStorage.key(e));newNoteToDOM(t=JSON.parse(t),templateNote,noteList),countNoteFooter.innerText=""+localStorage.length}function modalMove(t,e){e.classList.contains("no-active")?(e.classList.remove("no-active"),e.classList.add("active"),t.style.display="flex",gsap.to(t,{delay:.4,opacity:1,y:10,duration:1,zIndex:8,ease:"back.out(3)"})):(e.classList.remove("active"),e.classList.add("no-active"),gsap.to(t,{opacity:0,y:-10,zIndex:1,duration:1,ease:"back.in(3)"}),setTimeout(()=>{t.style.display="none"},1100))}function modalClose(t,e){e.classList.remove("active"),e.classList.add("no-active"),gsap.to(t,{opacity:0,y:-10,zIndex:1,duration:1,ease:"back.in(3)"}),setTimeout(()=>{t.style.display="none"},1100)}null==detect.mobile()?(window.addEventListener("pointerover",t=>{t.target.closest(".jsBtnAnimation")&&!t.target.closest(".options__filter-modal__btn__arrow--active")&&gsap.to(t.target.closest(".jsBtnAnimation"),{duration:.7,backgroundColor:"#d8d7d7"}),t.target.closest(".note-list__item__btns__btn")&&gsap.to(t.target.closest(".note-list__item__btns__btn"),{duration:.7,backgroundColor:"#d8d7d7"})}),window.addEventListener("pointerout",t=>{t.target.closest(".jsBtnAnimation")&&!t.target.closest(".options__filter-modal__btn__arrow--active")&&gsap.to(t.target.closest(".jsBtnAnimation"),{duration:.7,backgroundColor:"#ffffff"}),t.target.closest(".note-list__item__btns__btn")&&gsap.to(t.target.closest(".note-list__item__btns__btn"),{duration:.7,backgroundColor:"#ffffff"})})):window.addEventListener("click",t=>{t.target.closest(".jsBtnAnimation")&&(gsap.to(t.target.closest(".jsBtnAnimation"),{duration:.7,backgroundColor:"#fff"}),setTimeout(()=>{gsap.to(t.target.closest(".jsBtnAnimation"),{duration:.7,backgroundColor:"#ffffff"})},1800)),t.target.closest(".note-list__item__btns__btn")&&(gsap.to(t.target.closest(".note-list__item__btns__btn"),{duration:.7,backgroundColor:"#fff"}),setTimeout(()=>{gsap.to(t.target.closest(".note-list__item__btns__btn"),{duration:.7,backgroundColor:"#ffffff"})},1800))}),window.addEventListener("click",t=>{if(t.target.closest("#filter-btn")&&!t.target.closest(".options__filter-modal")?modalMove(modalFilter,filterBtn):t.target.closest("#filter-btn")||t.target.closest(".options__filter-modal")||filterBtn.classList.contains("active")&&modalClose(modalFilter,filterBtn),t.target.closest(".add-note__btn")&&!t.target.closest(".add-note__modal")?modalMove(modalAddNote,addNoteBtn):t.target.closest(".add-note__btn")||t.target.closest(".add-note__modal")||addNoteBtn.classList.contains("active")&&modalClose(modalAddNote,addNoteBtn),t.target.closest(".note__list__item__btns-delete")){var e=t.target.closest(".note__list__item__btns-delete").parentNode.parentNode.children[0].children[0].innerText;if(searchItemToStorage.getItemName(e)==e){for(let t=0;t<noteList.children.length;t++)noteList.children[t].children[0].innerText==e&&noteList.children[t].remove();localStorage.removeItem(e),countNoteFooter.innerText=""+localStorage.length}}if(t.target.closest(".note__list__item__btns-edit")){console.log("edit");var n=t.target.closest(".note__list__item__btns-edit").parentNode.parentNode.children[0].children[0].innerText;if(searchItemToStorage.getItemName(n)==n)for(let o=0;o<noteList.children.length;o++)if(noteList.children[o].children[0].innerText==n){let t=new Note,e=localStorage.getItem(n);(e=JSON.parse(e)).date.dateEdit=t.setDate(),localStorage.setItem(n,JSON.stringify(e)),noteList.children[o].children[1].innerText=e.date.dateEdit}}}),modalAddNote.addEventListener("click",t=>{t.target.closest(".add-note__modal__btn")&&(""!=modalAddNote.elements.addNoteTitle.value?(0==window.localStorage.length?addNoteToStorage(templateNote,noteList,modalAddNote.elements.addNoteTitle.value,modalAddNote.elements.addNoteSubTitle.value):searchItemToStorage.getItem(modalAddNote.elements.addNoteTitle.value)?(addNoteToStorage(templateNote,noteList,modalAddNote.elements.addNoteTitle.value,modalAddNote.elements.addNoteSubTitle.value),countNoteFooter.innerText=""+localStorage.length):(modalAddNote.elements.addNoteTitle.setAttribute("placeholder","Заметка уже существует!"),gsap.to(modalAddNote.elements.addNoteTitle,{borderColor:"red",boxShadow:"1px 1px red, 1px -1px red, -1px 1px red, -1px -1px red"})),modalAddNote.elements.addNoteTitle.value="",modalAddNote.elements.addNoteSubTitle.value=""):gsap.to(modalAddNote.elements.addNoteTitle,{borderColor:"red",boxShadow:"1px 1px red, 1px -1px red, -1px 1px red, -1px -1px red"})),t.target.closest(".add-note__modal__input")&&(modalAddNote.elements.addNoteTitle.setAttribute("placeholder","Название"),gsap.to(modalAddNote.elements.addNoteTitle,{borderColor:"black",boxShadow:"none"}))}),modalFilter.addEventListener("click",t=>{if(t.target.closest(".options__filter-modal__btn__arrow")&&(t.target.classList.contains("options__filter-modal__btn__arrow--up")&&(t.target.classList.add("options__filter-modal__btn__arrow--active"),document.querySelector("#arrowUp").setAttribute("checked","checked"),document.querySelector("#arrowDown").removeAttribute("checked"),document.querySelector(".options__filter-modal__btn__arrow--down").classList.remove("options__filter-modal__btn__arrow--active"),document.querySelector(".options__filter-modal__btn__arrow--down").style.backgroundColor="#fff"),t.target.classList.contains("options__filter-modal__btn__arrow--down")&&(t.target.classList.add("options__filter-modal__btn__arrow--active"),document.querySelector("#arrowDown").setAttribute("checked","checked"),document.querySelector("#arrowUp").removeAttribute("checked"),document.querySelector(".options__filter-modal__btn__arrow--up").classList.remove("options__filter-modal__btn__arrow--active"),document.querySelector(".options__filter-modal__btn__arrow--up").style.backgroundColor="#fff")),t.target.closest("#filter-modal-name")){if(document.querySelector("#arrowUp").getAttribute("checked")){var e=a(noteList.children,!0,"title");noteList.innerHTML="";for(let t=0;t<e.length;t++)noteList.appendChild(e[t])}if(document.querySelector("#arrowDown").getAttribute("checked")){var o=a(noteList.children,!1,"title");noteList.innerHTML="";for(let t=0;t<o.length;t++)noteList.appendChild(o[t])}}if(t.target.closest("#filter-modal-date-edit")){if(document.querySelector("#arrowUp").getAttribute("checked")){var n=a(noteList.children,!0,"date");noteList.innerHTML="";for(let t=0;t<n.length;t++)noteList.appendChild(n[t])}if(document.querySelector("#arrowDown").getAttribute("checked")){var l=a(noteList.children,!1,"date");noteList.innerHTML="";for(let t=0;t<l.length;t++)noteList.appendChild(l[t])}}function a(o,n,t){let l=[],a=[];if("title"==t){for(let t=0;t<o.length;t++)a.push(o[t].children[0].innerText.toUpperCase());a.sort();for(let e=0;e<=o.length-1;e++)for(let t=0;t<=a.length-1;t++)a[e]===o[t].children[0].innerText.toUpperCase()&&(n&&l.unshift(o[t]),n||l.push(o[t]))}if("date"==t){for(let t=0;t<o.length;t++)a.push(o[t].children[1].innerText);a.sort();for(let e=0;e<=o.length-1;e++)for(let t=0;t<=a.length-1;t++)a[e]===o[t].children[1].innerText&&(n&&l.unshift(o[t]),n||l.push(o[t]))}return l}});class Note{constructor(t,e){this.title=t,this.subtitle=e}content={element:""};date={dateAdd:"",dateEdit:""};setDate(){let t=new Date;return`${t.getDate()}.${t.getMonth()+1}.${t.getFullYear()} ${t.getHours()}:${t.getMinutes()}:`+t.getSeconds()}setContent(t){this.content.element=""+t}removeContent(){this.content.element=""}}function addNoteToStorage(t,e,o,n){let l=new Note(""+o,""+n);l.date.dateAdd=l.setDate(),l.date.dateEdit=l.date.dateAdd,localStorage.setItem(l.title,JSON.stringify(l)),newNoteToDOM(l,t,e)}function newNoteToDOM(t,e,o){e.content.querySelector(".note-list__item__subtitle").textContent=t.subtitle,e.content.querySelector(".note-list__item__title").textContent=t.title,e.content.querySelector(".note-list__item__date").textContent=t.date.dateEdit;t=e.content.cloneNode(!0);o.append(t)}let searchItemToStorage={getItem:e=>{let o=!0;for(let t=0;t<window.localStorage.length;t++){var n=window.localStorage.getItem(window.localStorage.key(t));if(JSON.parse(n).title==e){o=!1;break}o=!0}return o},getItemName:e=>{for(let t=0;t<window.localStorage.length;t++){var o=window.localStorage.getItem(window.localStorage.key(t));if((o=JSON.parse(o)).title==e)return o.title}}};